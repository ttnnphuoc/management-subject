app.controller("CommentsController",["$scope","$window","$timeout","CommonFactory",function(n,t,i,r){var u="/Comments/";n.Comments={};n.CommentList={};n.showCommentlist=function(t,i){var e=u+"GetCommentList",f;n.Comments.SUBJECTID=t;n.Comments.LESSONID=i;f=JSON.stringify({data:n.Comments});r.PostDataAjax(e,f,function(t){t?t.rs?n.CommentList=t.commentList:alert("Không nhận được phản hồi từ máy chủ"):alert("Không nhận được phản hồi từ máy chủ")})};n.Add=function(){n.Comments.COMMENT||alert("Nội dung không được để trống!");var t=u+"Add",i=JSON.stringify({data:n.Comments});r.PostDataAjax(t,i,function(t){t?t.rs?(n.Comments.COMMENT="",n.showCommentlist(n.Comments.SUBJECTID,n.Comments.LESSONID)):alert("Không nhận được phản hồi từ máy chủ"):alert("Không nhận được phản hồi từ máy chủ")})};n.doSomething=function(){n.Add()}}]);app.controller("SubjectController",["$scope","$window","$timeout","CommonFactory",function(n,t,i,r){var u="/Subjects/";n.SUBJECT={};n.SaveSubject=function(){var i=u+"Add",t;if(!n.SUBJECT.NAME){swal({title:"Thông Báo",text:"Nhập tên môn học",icon:"error",button:"OK"});return}t=JSON.stringify({sub:n.SUBJECT});r.PostDataAjax(i,t,function(n){if(n)if(n.rs)swal({title:"Thông Báo",text:n.msg,icon:"success",button:"OK"}).then(function(){window.location.href=u+"Index"});else{swal({title:"Thông Báo",text:n.msg,icon:"error",button:"OK"});return}else alert("Không nhận được phản hồi từ máy chủ")})}}]);$(function(){$("#jstree").jstree({plugins:["search","wholerow"],core:{data:{url:function(n){return n.id==="#"?"/Subjects/GetRoot":"/Subjects/GetChildren/"+n.id},data:function(n){return{id:n.id}}}}});$("#jstree").on("changed.jstree",function(n,t){t.node.parent!=="#"&&(variable1=t.node.original.id,variable2=t.node.original.parent,$("#overlay").show(),$.ajax({url:"/Lessons/GetFileByFolderID",type:"GET",data:{id:t.node.id},success:function(n){$("#overlay").hide();$(".content-wrapper").first().html(n);$("#comment-content").css("display","block");angular.element(document.getElementById("YourElementId")).scope().showCommentlist(variable1,variable2)},error:function(n){$("#overlay").hide();console.log(n)}}))});$("#jstree").bind("hover_node.jstree",function(){var n=$(this).find(".jstree-wholerow-hovered");n.css("height",n.parent().children("a.jstree-anchor").height()+"px")});$("#jstree-user").jstree({plugins:["search","wholerow"],core:{data:{url:function(n){return n.parents.length===0?"/Reports/GetRoot":n.parents.length===1?"/Reports/GetChildren/"+n.id:n.parents.length===2?"/Reports/GetChildrenSubject/"+n.id:n.parents.length===3?"/Reports/GetChildrenLesson/"+n.id:void 0},data:function(n){return{id:n.id}}}}});$("#jstree-user").on("changed.jstree",function(n,t){t.node.parent!=="#"&&($("#overlay").show(),$.ajax({url:"/Lessons/GetFileByFolderID",type:"GET",data:{id:t.node.id},success:function(n){$("#overlay").hide();$(".content-wrapper").html(n)},error:function(n){$("#overlay").hide();console.log(n)}}))});$("#jstree-user").bind("hover_node.jstree",function(){var n=$(this).find(".jstree-wholerow-hovered");n.css("height",n.parent().children("a.jstree-anchor").height()+"px")})});$(function(){$("#btn-info").on("click",function(){$.ajax({url:"/ManagerStudents/GetUserByRole",type:"GET",success:function(n){var r="",i,t;for(i of n)r+="<tr><td class='del-student pointer' data-id='"+i.ID+"'><i class='far fa-square'><\/i><\/td><td class='copy-student pointer' data-id='"+i.ID+"'><i class='far fa-square'><\/i><\/td><td>"+i.Fullname+"<\/td>";$("#info-student tbody").html("");$("#info-student tbody").html(r);t="fa-check-square";$("td.del-student").on("click",function(n){var f=n.currentTarget,i=f.querySelector("i"),r,u;i&&(r=i.classList,r.contains("fa-square")?(i.classList.remove("fa-square"),i.classList.add(t),u=$(n.currentTarget).closest("tr").find(".copy-student"),u&&(i=u[0].querySelector("i"),r=i.classList,r.contains(t)&&(i.classList.remove(t),i.classList.add("fa-square")))):r.contains(t)&&(i.classList.remove(t),i.classList.add("fa-square")))});$("td.copy-student").on("click",function(){var u=event.currentTarget,n=u.querySelector("i"),i,r;n&&(i=n.classList,i.contains("fa-square")?(n.classList.remove("fa-square"),n.classList.add(t),r=$(event.currentTarget).closest("tr").find(".del-student"),r&&(n=r[0].querySelector("i"),i=n.classList,i.contains(t)&&(n.classList.remove(t),n.classList.add("fa-square")))):i.contains(t)&&(n.classList.remove(t),n.classList.add("fa-square")))})},error:function(n){console.log(n)}})});$("#btn-go").on("click",function(){var s=$("#info-student tbody tr td"),r=$("#select-subject").val(),i,n,u,f,t,e,o;if(r==="-1"){swal({title:"Thông Báo!",text:"Vui lòng chọn môn học",icon:"error",button:"OK"});return}i=[];for(n of s)u=n.querySelector("i"),u&&(f=u.classList,f.contains("fa-check-square")&&(t="",n.classList.contains("del-student")?t="D_"+n.dataset.id+"_"+r:n.classList.contains("copy-student")&&(t="C_"+n.dataset.id+"_"+r),i.push(t),t=""));if(i.length===0){swal({title:"Thông Báo!",text:"Vui lòng chọn học sinh",icon:"error",button:"OK"});return}e=JSON.stringify({data:i});o="/ManagerStudents/AddStudentToSubject";$.ajax({url:o,type:"POST",data:e,dataType:"json",contentType:"application/json; charset=utf-8",success:function(n){swal({title:"Thông Báo!",text:n,icon:"success",button:"OK"}).then(function(){location.reload()})},error:function(){}})})});